const gameWrapper = document.querySelector("#game-wrapper");
const inputContainer = gameWrapper.querySelector(".input-container");
const playerInput = inputContainer.querySelector(".player-input");
const playerListDiv = inputContainer.querySelector(".players-list");
let playersElements = playerListDiv.getElementsByClassName("player");
let currentIndex = 0;

playerInput.addEventListener("keyup", (e) => {
    let ignoreKeys = ["ArrowUp", "ArrowDown", "Enter"]
    if (ignoreKeys.includes(e.key)) {
        return;
    }
    playerListDiv.innerHTML = "";
    let inputString = playerInput.value.toLowerCase();
    if (inputString.length < 3) {
        return;
    }

    players.forEach(player => {
        let firstName = player["name"]["first"];
        let lastName = player["name"]["last"];
        if (lastName.toLowerCase().startsWith(inputString)) {
            createPlayerListElement(player);
        } else if (firstName && firstName.toLowerCase().startsWith(inputString)) {
            createPlayerListElement(player);
        }
        playerListDiv.classList.add("active");
    })

    if (playerListDiv.innerHTML === "") {
        playerListDiv.innerHTML = `<p>Oops! No players found.</p>`;
        playerListDiv.classList.remove("active");
    }
})





function createPlayerListElement(player) {
    let li = document.createElement("li");
    li.classList.add("player")
    li.setAttribute("onclick", "playerListElementClick(this)");
    li.setAttribute("player_id", player["player_id"]);
    
    let nameDiv = document.createElement("div");
    nameDiv.classList.add("name");
    
    if (player["name"]["first"]) {
        let firstNameDiv = document.createElement("div");
        firstNameDiv.classList.add("first");
        firstNameDiv.textContent = player["name"]["first"]
        nameDiv.appendChild(firstNameDiv);
    }
    
    lastNameDiv = document.createElement("div");
    lastNameDiv.classList.add("last");
    lastNameDiv.textContent = player["name"]["last"];
    nameDiv.appendChild(lastNameDiv);
    
    imageDiv = document.createElement("div");
    imageDiv.classList.add("image");
    imageEl = document.createElement("img");
    imageDiv.appendChild(imageEl)
    if (player["image"]) {
        imageEl.setAttribute("src", player["image"])
    } else{
        imageEl.setAttribute("src", "https://resources.premierleague.com/premierleague/photos/players/250x250/Photo-Missing.png");
    }
    
    li.appendChild(nameDiv);
    li.appendChild(imageDiv);
    
    playerListDiv.appendChild(li);

    currentIndex = 0;
    updateSelectedPlayer(currentIndex);
}

function playerListElementClick(playerElement) {
    let playerId = playerElement.getAttribute("player_id");

    console.log(playerId);

    playerInput.value = "";
    playerListDiv.innerHTML = ""
}

function updateSelectedPlayer(currentIndex) {
    let playersElements = playerListDiv.getElementsByClassName("player");

    playersElements[currentIndex].classList.add("active");
}

document.addEventListener("keydown", (e) => {
    if (playerListDiv.classList.contains("active")) {
        if (e.key === "ArrowUp") {
            playersElements[currentIndex].classList.remove("active");
            if (currentIndex > 0) {
                currentIndex--;
            } else {
                currentIndex = playersElements.length - 1;
            }
            updateSelectedPlayer(currentIndex)
        } else if (e.key === "ArrowDown") {
            playersElements[currentIndex].classList.remove("active");
            if (currentIndex >= playersElements.length - 1) {
                currentIndex = 0;
            } else {
                currentIndex++;
            }
            updateSelectedPlayer(currentIndex)
        }
        if (e.key === "Enter") {
            if (playersElements[currentIndex]) {
                playerListElementClick(playersElements[currentIndex])
            }
        }
    }
})

const questions = [
    {
        "prompt": "wears number 9",
        "solutions": [
            "19680",
            "134048",
            "33032",
            "124052",
            "72371",
            "14451",
            "65970",
            "15340",
            "9199",
            "24630",
            "9595",
            "11130",
            "35670",
            "9576",
            "117763",
            "8979",
            "70287",
            "122934",
            "8454"
        ]
    },
    {
        "prompt": "wears number 1",
        "solutions": [
            "33280",
            "75709",
            "14538",
            "13988",
            "4573",
            "71923",
            "3309",
            "15715",
            "4640",
            "4985",
            "19911",
            "4522",
            "15332",
            "20559",
            "71744",
            "6451"
        ]
    },
    {
        "prompt": "is from France",
        "solutions": [
            "66204",
            "5758",
            "25067",
            "51830",
            "54893",
            "53612",
            "68827",
            "66284",
            "16784",
            "20874",
            "76104",
            "74960",
            "118579",
            "5748",
            "63656",
            "126108",
            "145114",
            "49884",
            "50247",
            "16788",
            "23593",
            "118591"
        ]
    },
    {
        "prompt": "is from Brazil",
        "solutions": [
            "50234",
            "19680",
            "66104",
            "6593",
            "12994",
            "33032",
            "124052",
            "148162",
            "21912",
            "72371",
            "139004",
            "133681",
            "12707",
            "126943",
            "112510",
            "139648",
            "147272",
            "67510",
            "24630",
            "55776",
            "146354",
            "133679",
            "51202",
            "147032",
            "143214",
            "10476",
            "117763",
            "50501",
            "20559",
            "5793",
            "75381",
            "74761",
            "20607"
        ]
    },
    {
        "prompt": "is from Germany",
        "solutions": [
            "20810",
            "127594",
            "23194",
            "134176",
            "47133",
            "5101",
            "146394",
            "108325",
            "23599",
            "42569",
            "4985",
            "31671"
        ]
    },
    {
        "prompt": "is from Argentina",
        "solutions": [
            "4245",
            "26408",
            "54989",
            "63741",
            "115172",
            "66635",
            "40159",
            "133430",
            "63633",
            "67191",
            "68987"
        ]
    },
    {
        "prompt": "is born in 1980-1989",
        "solutions": [
            "6593",
            "3909",
            "2100",
            "3929",
            "2250",
            "4573",
            "4618",
            "3170",
            "3309",
            "8897",
            "3062",
            "3600",
            "12582",
            "2537",
            "8979",
            "2933",
            "3156",
            "6451",
            "2896"
        ]
    },
    {
        "prompt": "any player",
        "solutions": [
            "66204",
            "12185",
            "14548",
            "50234",
            "67776",
            "109478",
            "115169",
            "19620",
            "4936",
            "49481",
            "11419",
            "5682",
            "20810",
            "15202",
            "19680",
            "66104",
            "20486",
            "114564",
            "114566",
            "7975",
            "119036",
            "69914",
            "19778",
            "6593",
            "4316",
            "92734",
            "127722",
            "4245",
            "11224",
            "13344",
            "12994",
            "13274",
            "8900",
            "5758",
            "21529",
            "10000",
            "51423",
            "5865",
            "26408",
            "19888",
            "25067",
            "8658",
            "134048",
            "20489",
            "51901",
            "23968",
            "51223",
            "4115",
            "64519",
            "108096",
            "98302",
            "107846",
            "107891",
            "114470",
            "124179",
            "138560",
            "124181",
            "114058",
            "127888",
            "112745",
            "19970",
            "116665",
            "3512",
            "51942",
            "54989",
            "67546",
            "10766",
            "13706",
            "15572",
            "74976",
            "14846",
            "8882",
            "133890",
            "21519",
            "25474",
            "53093",
            "50453",
            "42894",
            "50498",
            "16582",
            "123585",
            "64370",
            "33032",
            "11373",
            "33280",
            "24659",
            "115166",
            "10947",
            "22043",
            "3909",
            "20113",
            "21297",
            "128891",
            "42331",
            "49726",
            "127594",
            "14457",
            "117497",
            "66360",
            "49731",
            "23194",
            "24369",
            "144788",
            "126962",
            "128264",
            "144265",
            "124052",
            "98258",
            "23946",
            "128890",
            "132068",
            "32289",
            "65987",
            "148162",
            "122142",
            "75709",
            "3457",
            "23704",
            "21912",
            "9426",
            "8163",
            "76090",
            "31904",
            "4874",
            "2100",
            "8171",
            "108751",
            "117732",
            "134333",
            "72371",
            "3452",
            "125827",
            "126317",
            "71590",
            "124396",
            "112739",
            "92610",
            "49173",
            "136175",
            "72239",
            "48290",
            "117451",
            "134176",
            "51830",
            "122282",
            "14671",
            "50727",
            "4511",
            "14538",
            "65641",
            "54893",
            "27277",
            "53612",
            "13491",
            "14571",
            "51229",
            "68827",
            "66284",
            "63741",
            "53991",
            "64140",
            "67407",
            "110526",
            "16784",
            "125075",
            "49293",
            "112203",
            "75212",
            "99282",
            "139004",
            "118442",
            "13549",
            "117753",
            "109777",
            "130068",
            "14706",
            "119078",
            "75989",
            "21998",
            "50856",
            "14801",
            "10827",
            "3929",
            "24334",
            "14569",
            "4604",
            "50842",
            "37776",
            "21584",
            "8980",
            "8589",
            "126670",
            "133681",
            "20874",
            "13988",
            "11575",
            "76353",
            "69595",
            "112449",
            "138981",
            "134955",
            "49759",
            "110549",
            "125106",
            "49796",
            "76104",
            "14451",
            "54760",
            "14575",
            "47133",
            "12707",
            "2250",
            "3955",
            "16431",
            "4505",
            "4499",
            "67178",
            "15656",
            "99281",
            "12520",
            "4260",
            "16286",
            "4288",
            "5067",
            "14805",
            "49270",
            "65970",
            "48690",
            "76204",
            "66657",
            "54156",
            "126943",
            "5101",
            "134787",
            "119879",
            "23811",
            "10933",
            "16204",
            "10439",
            "15259",
            "14238",
            "22624",
            "112510",
            "15340",
            "3756",
            "49259",
            "20701",
            "16723",
            "53085",
            "139648",
            "117754",
            "108816",
            "115172",
            "23702",
            "51593",
            "146394",
            "16035",
            "147272",
            "133025",
            "144693",
            "37221",
            "115446",
            "67510",
            "4617",
            "4573",
            "9462",
            "63840",
            "13815",
            "14252",
            "10565",
            "107842",
            "19589",
            "13956",
            "14997",
            "123910",
            "112917",
            "9199",
            "112549",
            "118447",
            "4618",
            "108325",
            "15713",
            "25447",
            "8691",
            "72360",
            "24716",
            "67238",
            "14383",
            "14242",
            "25281",
            "74960",
            "119072",
            "122173",
            "147822",
            "129919",
            "144853",
            "13703",
            "8052",
            "16758",
            "71923",
            "3170",
            "15114",
            "15111",
            "39606",
            "66635",
            "32229",
            "23764",
            "4408",
            "75582",
            "126824",
            "50245",
            "49316",
            "117318",
            "22802",
            "8456",
            "4999",
            "24630",
            "69070",
            "23599",
            "49374",
            "133603",
            "117596",
            "119462",
            "10443",
            "118579",
            "127853",
            "3309",
            "5748",
            "8897",
            "7336",
            "16803",
            "55776",
            "40211",
            "25183",
            "9595",
            "8245",
            "8868",
            "32638",
            "109714",
            "51364",
            "146354",
            "3881",
            "13522",
            "65961",
            "42569",
            "40159",
            "63656",
            "14164",
            "16268",
            "15715",
            "9651",
            "10801",
            "4229",
            "71432",
            "4198",
            "16642",
            "92635",
            "117315",
            "5583",
            "19814",
            "133679",
            "20337",
            "51202",
            "11130",
            "108319",
            "43010",
            "24637",
            "126108",
            "139644",
            "108947",
            "115114",
            "23989",
            "35670",
            "147032",
            "132169",
            "145114",
            "4331",
            "143214",
            "74608",
            "108956",
            "4640",
            "14428",
            "74585",
            "4333",
            "8143",
            "3062",
            "24983",
            "3600",
            "66318",
            "13823",
            "12582",
            "23841",
            "119034",
            "24797",
            "9576",
            "33135",
            "66538",
            "31936",
            "112589",
            "112267",
            "2537",
            "49738",
            "31442",
            "118112",
            "126789",
            "112601",
            "127754",
            "69603",
            "117608",
            "4985",
            "4880",
            "23793",
            "49884",
            "14624",
            "4818",
            "13961",
            "3894",
            "10476",
            "16044",
            "11071",
            "117763",
            "50501",
            "31671",
            "6712",
            "128976",
            "4979",
            "4717",
            "14656",
            "14445",
            "35752",
            "107805",
            "124083",
            "21614",
            "26151",
            "14450",
            "8159",
            "53075",
            "19877",
            "51454",
            "14203",
            "11000",
            "13559",
            "7865",
            "8388",
            "19723",
            "4432",
            "8201",
            "10874",
            "51703",
            "14283",
            "14636",
            "98300",
            "49254",
            "51813",
            "19911",
            "15212",
            "4864",
            "10768",
            "8417",
            "108613",
            "32715",
            "15154",
            "33128",
            "4522",
            "118083",
            "25444",
            "13515",
            "20566",
            "4136",
            "5343",
            "20109",
            "7488",
            "13248",
            "20479",
            "51553",
            "112742",
            "66518",
            "8979",
            "14458",
            "24994",
            "15332",
            "23796",
            "50247",
            "117859",
            "8192",
            "66011",
            "127644",
            "133430",
            "21413",
            "5595",
            "123333",
            "16788",
            "20559",
            "14723",
            "10651",
            "5140",
            "23593",
            "16006",
            "10458",
            "14732",
            "33231",
            "63633",
            "23815",
            "33185",
            "66669",
            "70287",
            "5178",
            "32894",
            "19758",
            "51557",
            "68582",
            "43586",
            "49909",
            "134820",
            "51559",
            "130665",
            "24807",
            "51574",
            "15802",
            "2933",
            "11026",
            "5066",
            "9566",
            "67191",
            "23581",
            "24252",
            "4608",
            "3156",
            "67221",
            "14580",
            "23396",
            "4845",
            "5793",
            "112653",
            "108936",
            "122934",
            "13565",
            "69176",
            "75381",
            "68987",
            "71744",
            "133503",
            "124366",
            "50848",
            "118591",
            "33245",
            "20226",
            "118031",
            "6451",
            "10079",
            "8321",
            "3905",
            "49908",
            "5220",
            "9257",
            "4815",
            "66494",
            "49495",
            "8707",
            "4713",
            "71623",
            "14716",
            "9662",
            "54312",
            "14446",
            "14897",
            "74761",
            "117647",
            "20607",
            "8454",
            "23747",
            "21737",
            "127659",
            "125185",
            "21585",
            "2896",
            "20547",
            "108922",
            "114590"
        ]
    },
    {
        "prompt": "is from the Netherlands",
        "solutions": [
            "67776",
            "92734",
            "51223",
            "98302",
            "107846",
            "21519",
            "33280",
            "65987",
            "75709",
            "76090",
            "4874",
            "72239",
            "4499",
            "75582",
            "65961",
            "117608",
            "4880",
            "5140",
            "32894",
            "49909",
            "23581",
            "50848",
            "20226",
            "49908"
        ]
    }
]
